Qfilter(p_brand,p_type,p_size,ps_suppkey) :- partsupp(p_partkey,ps_suppkey,ps1,ps2,ps3), part(p_partkey,p1,p2,p_brand,p_type,p_size,p3,p4,p5), p_brand != 'Brand#45' . Qcomplaints(ps_suppkey,0) :- Qfilter(x1,x2,x3,ps_suppkey) . Qcomplaints(s_suppkey,1) :- supplier(s_suppkey,s1,s2,s3,s4,s5,s_comment) . Qttlcom(ps_suppkey, sum(cnt)) :- Qcomplaints(ps_suppkey, cnt) . Qaggin(p_brand,p_type,p_size,ps_suppkey) :- Qfilter(p_brand,p_type,p_size,ps_suppkey), Qttlcom(ps_suppkey, 0) . Q(p_brand,p_type,p_size,count(s_suppkey)) :- Qaggin(p_brand,p_type,p_size,s_suppkey) .
